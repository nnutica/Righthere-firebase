<?xml version="1.0" encoding="utf-8"?>
<ContentPage
    x:Class="Firebasemauiapp.Mainpages.StarterView"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    Title="StarterView"
    BackgroundImageSource="main_bg.png"
    Shell.FlyoutBehavior="Flyout"
    Shell.NavBarIsVisible="False"
    Shell.BackgroundColor="Transparent">

    <Shell.BackButtonBehavior>
        <BackButtonBehavior IsVisible="False"
                            IsEnabled="False"/>
    </Shell.BackButtonBehavior>

    <!-- New structure: content on top, rounded white strip under TabBar -->
    <!-- Increase strip height slightly for smoother curve alignment -->
    <Grid RowDefinitions="*,32">
        <!-- Top content area (everything you had before) -->
        <Grid Grid.Row="0"
              RowDefinitions="Auto,*">
            <!-- Header row with hamburger and coin badge -->
            <Grid Grid.Row="0"
                  BackgroundColor="Transparent"
                  Padding="12,8,12,4">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <Button Grid.Column="0"
                        Command="{Binding OpenFlyoutCommand}"
                        BackgroundColor="#33000000"
                        TextColor="White"
                        WidthRequest="44"
                        HeightRequest="44"
                        CornerRadius="22"
                        Padding="0"
                        FontSize="24"
                        Text="â‰¡"/>

                <!-- Coin badge -->
                <Border Grid.Column="2"
                        BackgroundColor="#66000000"
                        StrokeThickness="0"
                        HorizontalOptions="End"
                        VerticalOptions="Center">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="12"/>
                    </Border.StrokeShape>
                    <HorizontalStackLayout Padding="10,6"
                                           Spacing="6">
                        <Label Text="ðŸª™"
                               FontSize="16"
                               TextColor="Gold"/>
                        <Label Text="{Binding Coin}"
                               FontSize="16"
                               TextColor="White"/>
                    </HorizontalStackLayout>
                </Border>
            </Grid>

            <!-- Main content -->
            <Grid Grid.Row="1">
                <VerticalStackLayout Padding="30"
                                     Spacing="20"
                                     VerticalOptions="Start"
                                     Margin="0,20,0,40">
                    <Label FontAttributes="Bold"
                           FontSize="32"
                           HorizontalOptions="Center"
                           Text="Welcome!"/>

                    <Label FontSize="24"
                           HorizontalOptions="Center"
                           Text="{Binding UserName}"
                           TextColor="Blue"/>

                    <!-- Plant and radial menu area -->
                    <Grid x:Name="PlantArea"
                          WidthRequest="220"
                          HeightRequest="220"
                          HorizontalOptions="Center"
                          VerticalOptions="Start">
                        <!-- Your Diary (top) -->
                        <VerticalStackLayout x:Name="YourDiaryStack"
                                             IsVisible="False"
                                             Opacity="0"
                                             Scale="0.85"
                                             TranslationY="12"
                                             HorizontalOptions="Center"
                                             VerticalOptions="Start"
                                             Spacing="6"
                                             ZIndex="2">
                            <Border BackgroundColor="#E6E6E6"
                                    WidthRequest="96"
                                    HeightRequest="96"
                                    StrokeThickness="0"
                                    InputTransparent="False">
                                <Border.StrokeShape>
                                    <Ellipse/>
                                </Border.StrokeShape>
                                <Border.GestureRecognizers>
                                    <TapGestureRecognizer Command="{Binding GoYourDiaryCommand}"
                                                          NumberOfTapsRequired="1"/>
                                </Border.GestureRecognizers>
                                <Grid>
                                    <Image Source="history.png"
                                           WidthRequest="36"
                                           HeightRequest="36"
                                           HorizontalOptions="Center"
                                           VerticalOptions="Center"
                                           InputTransparent="True"/>
                                </Grid>
                            </Border>
                            <Label Text="Your Diary"
                                   FontSize="14"
                                   HorizontalOptions="Center"
                                   TextColor="Black"/>
                        </VerticalStackLayout>

                        <!-- Write a Diary (left) -->
                        <VerticalStackLayout x:Name="WriteDiaryStack"
                                             IsVisible="False"
                                             Opacity="0"
                                             Scale="0.85"
                                             TranslationY="12"
                                             HorizontalOptions="Start"
                                             VerticalOptions="Center"
                                             Spacing="6"
                                             Margin="0,0,0,0"
                                             ZIndex="2">
                            <Border BackgroundColor="#E6E6E6"
                                    WidthRequest="96"
                                    HeightRequest="96"
                                    StrokeThickness="0"
                                    InputTransparent="False">
                                <Border.StrokeShape>
                                    <Ellipse/>
                                </Border.StrokeShape>
                                <Border.GestureRecognizers>
                                    <TapGestureRecognizer Command="{Binding GoWriteDiaryCommand}"
                                                          NumberOfTapsRequired="1"/>
                                </Border.GestureRecognizers>
                                <Grid>
                                    <Image Source="diary.png"
                                           WidthRequest="36"
                                           HeightRequest="36"
                                           HorizontalOptions="Center"
                                           VerticalOptions="Center"
                                           InputTransparent="True"/>
                                </Grid>
                            </Border>
                            <Label Text="Write a Diary"
                                   FontSize="14"
                                   HorizontalOptions="Center"
                                   TextColor="Black"/>
                        </VerticalStackLayout>

                        <!-- Center Plant Button -->
                        <ImageButton x:Name="PlantButton"
                                     Source="empty.png"
                                     BackgroundColor="Transparent"
                                     Command="{Binding ToggleMenuCommand}"
                                     WidthRequest="200"
                                     HeightRequest="200"
                                     HorizontalOptions="Center"
                                     VerticalOptions="End"
                                     ZIndex="1"/>
                    </Grid>
                </VerticalStackLayout>
            </Grid>
        </Grid>

        <!-- Bottom white rounded strip under TabBar -->
        <Border Grid.Row="1"
                BackgroundColor="White"
                StrokeThickness="0"
                Margin="0"
                TranslationY="8">
            <Border.Shadow>
                <Shadow Brush="Black"
                        Opacity="0.18"
                        Radius="14"
                        Offset="0,-2"/>
            </Border.Shadow>
            <Border.StrokeShape>
                <!-- Slightly larger corner radius for a softer top edge -->
                <RoundRectangle CornerRadius="28,28,0,0"/>
            </Border.StrokeShape>
        </Border>
    </Grid>
</ContentPage>