<?xml version="1.0" encoding="utf-8"?>
<ContentPage
    x:Class="Firebasemauiapp.Mainpages.StarterView"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Name="Root"
    Title="StarterView"
    Shell.FlyoutBehavior="Disabled"
    Shell.NavBarIsVisible="False"
    Shell.BackgroundColor="Transparent"
    BackgroundColor="White">

    <Shell.BackButtonBehavior>
        <BackButtonBehavior IsVisible="False"
                            IsEnabled="False"/>
    </Shell.BackButtonBehavior>

    <Grid>
        <Grid Padding="16,12,16,0"
              RowSpacing="10"
              RowDefinitions="Auto,Auto,*">

        <!-- ===== HEADER ===== -->
        <VerticalStackLayout Grid.Row="0"
                             Spacing="6">

            <Grid ColumnDefinitions="*,Auto">
                <!-- Logo -->
                <Image Source="logo.png"
                       HeightRequest="60"
                       WidthRequest="84"
                       Margin="10,0,0,0"
                       HorizontalOptions="Start"/>
                
                <!-- Logout Button -->
                <Button Grid.Column="1"
                        Text="Log out"
                        TextColor="#FF6B6B"
                        BackgroundColor="Transparent"
                        FontAttributes="Bold"
                        FontSize="14"
                        HeightRequest="40"
                        VerticalOptions="Center"
                        Margin="0,0,10,0"
                        Command="{Binding LogOutCommand}"/>
            </Grid>


            <!-- Welcome Text -->
            <Label Text="Welcome Home,"
                   FontSize="32"
                   FontAttributes="Bold"
                   FontFamily="contextfont"
                   TextColor="#8FAF8B"
                   LineHeight="1.0"/>
            <Label Text="{Binding WelcomeMessage}"
                   FontSize="32"
                   FontAttributes="Bold"
                   FontFamily="contextfont"
                   TextColor="#8FAF8B"
                   LineHeight="1.0"
                   Margin="0,-8,0,0"/>

            <!-- Subtitle -->
            <Label Text="Your safe space is ready."
                   FontSize="16"
                   FontFamily="regularfont"
                   TextColor="#A9BEA6"/>

        </VerticalStackLayout>

        <ScrollView Grid.Row="1"
                    Grid.RowSpan="2">
            <VerticalStackLayout Spacing="10">
                <!-- ===== DIARY BUTTON (FULL WIDTH) ===== -->
                <ImageButton
                    Source="btn_diary.png"
                    Aspect="AspectFill"
                    CornerRadius="28"
                    HeightRequest="140"
                    Padding="0"
                    Margin="0,4,0,0"
                    BackgroundColor="Transparent"
                    Command="{Binding GoDiaryCommand}"/>

                <!-- ===== GRID BUTTONS ===== -->
                <Grid
                    ColumnSpacing="10"
                    RowSpacing="6"
                    ColumnDefinitions="*,*"
                    RowDefinitions="140,70,140">

                    <!-- Quests (left top) -->
                    <ImageButton Grid.Row="0"
                                 Grid.Column="0"
                                 Source="btn_quest.png"
                                 Aspect="AspectFill"
                                 CornerRadius="28"
                                 HeightRequest="140"
                                 Padding="0"
                                 VerticalOptions="Start"
                                 BackgroundColor="Transparent"
                                 Command="{Binding GoQuestCommand}"/>

                    <!-- Store (Right bottom) -->
                    <ImageButton Grid.Row="2"
                                 Grid.Column="1"
                                 Source="btn_store.png"
                                 Aspect="AspectFill"
                                 CornerRadius="28"
                                 HeightRequest="140"
                                 Padding="0"
                                 BackgroundColor="Transparent"
                                 Command="{Binding GoStoreCommand}"/>

                    <!-- Mind Dashboard (right top-middle) -->
                    <ImageButton Grid.Row="0"
                                 Grid.Column="1"
                                 Grid.RowSpan="2"
                                 Source="btn_dashboard.png"
                                 Aspect="AspectFill"
                                 CornerRadius="28"
                                 HeightRequest="210"
                                 Padding="0"
                                 VerticalOptions="Start"
                                 BackgroundColor="Transparent"
                                 Command="{Binding GoDashboardCommand}"/>

                    <!-- Kindness Forest (left middle-bottom) -->
                    <ImageButton Grid.Row="1"
                                 Grid.Column="0"
                                 Grid.RowSpan="2"
                                 Source="btn_forest.png"
                                 Aspect="AspectFill"
                                 CornerRadius="28"
                                 HeightRequest="210"
                                 Padding="0"
                                 BackgroundColor="Transparent"
                                 Command="{Binding GoForestCommand}"/>
                </Grid>
            </VerticalStackLayout>
        </ScrollView>

        </Grid>

        <!-- Loading Overlay -->
        <Grid BackgroundColor="#F0FFFFFF"
              IsVisible="{Binding IsLoading}"
              InputTransparent="False"
              ZIndex="999">
             <VerticalStackLayout VerticalOptions="Center" HorizontalOptions="Center" Spacing="20">
                <ActivityIndicator IsRunning="{Binding IsLoading}"
                                   Color="#8FAF8B"
                                   HeightRequest="50"
                                   WidthRequest="50"/>
                <Label Text="Getting things ready..." 
                       TextColor="#8FAF8B" 
                       FontSize="18"
                       FontAttributes="Bold"
                       FontFamily="mediumfont"
                       HorizontalOptions="Center"/>
             </VerticalStackLayout>
        </Grid>
    </Grid>
</ContentPage>
