<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="Firebasemauiapp.Mainpages.StarterView"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    Title="StarterView"
    BackgroundImageSource="main_bg.png"
    Shell.FlyoutBehavior="Flyout"
    Shell.NavBarIsVisible="False"
    Shell.BackgroundColor="Transparent">
    <Shell.BackButtonBehavior>
        <BackButtonBehavior IsVisible="False"
                            IsEnabled="False"/>
    </Shell.BackButtonBehavior>
    <Grid>
        <!-- Custom header row with hamburger menu -->
        <Grid RowDefinitions="Auto,*">
            <Grid Grid.Row="0"
                  BackgroundColor="Transparent"
                  Padding="12,8,12,4">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <Button Grid.Column="0"
                        Command="{Binding OpenFlyoutCommand}"
                        BackgroundColor="#33000000"
                        TextColor="White"
                        WidthRequest="44"
                        HeightRequest="44"
                        CornerRadius="22"
                        Padding="0"
                        FontSize="24"
                        Text="â‰¡"/>
                <!-- Coin badge in header, aligned to the right -->
                <Border Grid.Column="2"
                        BackgroundColor="#66000000"
                        StrokeThickness="0"
                        HorizontalOptions="End"
                        VerticalOptions="Center">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="12"/>
                    </Border.StrokeShape>
                    <HorizontalStackLayout Padding="10,6"
                                           Spacing="6">
                        <Label Text="ðŸª™"
                               FontSize="16"
                               TextColor="Gold"/>
                        <Label Text="{Binding Coin}"
                               FontSize="16"
                               TextColor="White"/>
                    </HorizontalStackLayout>
                </Border>
            </Grid>
            <Grid Grid.Row="1">
                <!-- Main content -->
                <VerticalStackLayout Padding="30"
                                     Spacing="20"
                                     VerticalOptions="Center">
                    <Label FontAttributes="Bold"
                           FontSize="32"
                           HorizontalOptions="Center"
                           Text="Welcome!"/>
                    <Label FontSize="24"
                           HorizontalOptions="Center"
                           Text="{Binding UserName}"
                           TextColor="Blue"/>

                    <!-- Plant and radial menu area -->
                    <Grid x:Name="PlantArea"
                          WidthRequest="240"
                          HeightRequest="280"
                          HorizontalOptions="Center"
                          VerticalOptions="Center">
                        <!-- Your Diary (top) -->
                        <VerticalStackLayout x:Name="YourDiaryStack"
                                             IsVisible="False"
                                             Opacity="0"
                                             Scale="0.85"
                                             TranslationY="12"
                                             HorizontalOptions="Center"
                                             VerticalOptions="Start"
                                             Spacing="6"
                                             ZIndex="2">
                            <Border BackgroundColor="#E6E6E6"
                                    WidthRequest="96"
                                    HeightRequest="96"
                                    StrokeThickness="0">
                                <Border.StrokeShape>
                                    <Ellipse/>
                                </Border.StrokeShape>
                                <Border.GestureRecognizers>
                                    <TapGestureRecognizer Command="{Binding GoYourDiaryCommand}"/>
                                </Border.GestureRecognizers>
                                <Image Source="history.png"
                                       WidthRequest="36"
                                       HeightRequest="36"
                                       HorizontalOptions="Center"
                                       VerticalOptions="Center"
                                       InputTransparent="True"/>
                            </Border>
                            <Label Text="Your Diary"
                                   FontSize="14"
                                   HorizontalOptions="Center"
                                   TextColor="Black"/>
                        </VerticalStackLayout>

                        <!-- Write a Diary (left) -->
                        <VerticalStackLayout x:Name="WriteDiaryStack"
                                             IsVisible="False"
                                             Opacity="0"
                                             Scale="0.85"
                                             TranslationY="12"
                                             HorizontalOptions="Start"
                                             VerticalOptions="Center"
                                             Spacing="6"
                                             Margin="0,0,0,0"
                                             ZIndex="2">
                            <Border BackgroundColor="#E6E6E6"
                                    WidthRequest="96"
                                    HeightRequest="96"
                                    StrokeThickness="0">
                                <Border.StrokeShape>
                                    <Ellipse/>
                                </Border.StrokeShape>
                                <Border.GestureRecognizers>
                                    <TapGestureRecognizer Command="{Binding GoWriteDiaryCommand}"/>
                                </Border.GestureRecognizers>
                                <Image Source="diary.png"
                                       WidthRequest="36"
                                       HeightRequest="36"
                                       HorizontalOptions="Center"
                                       VerticalOptions="Center"
                                       InputTransparent="True"/>
                            </Border>
                            <Label Text="Write a Diary"
                                   FontSize="14"
                                   HorizontalOptions="Center"
                                   TextColor="Black"/>
                        </VerticalStackLayout>

                        <!-- Center Plant Button -->
                        <ImageButton x:Name="PlantButton"
                                     Source="empty.png"
                                     BackgroundColor="Transparent"
                                     Command="{Binding ToggleMenuCommand}"
                                     WidthRequest="200"
                                     HeightRequest="200"
                                     HorizontalOptions="Center"
                                     VerticalOptions="End"
                                     ZIndex="1"/>
                    </Grid>
                </VerticalStackLayout>


            </Grid>
        </Grid>
    </Grid>
</ContentPage>